!function(e){var t={};function o(l){if(t[l])return t[l].exports;var s=t[l]={i:l,l:!1,exports:{}};return e[l].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=t,o.d=function(e,t,l){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:l})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=13)}([function(e,t,o){"use strict";var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e,t){var o,s=[];for(o in e)if(e.hasOwnProperty(o)){var r=t?t+"["+o+"]":o,a=e[o];s.push(null!==a&&"object"===(void 0===a?"undefined":l(a))?stella.util.serialize(a,r):encodeURIComponent(r)+"="+encodeURIComponent(a))}return s.join("&")}},function(e,t,o){"use strict";e.exports=function(e){return localStorage.setItem("stellaAccount",JSON.stringify(e)),!0}},function(e,t,o){"use strict";e.exports=function(){return JSON.parse(localStorage.getItem("stellaAccount"))}},function(e,t,o){"use strict";e.exports=[]},function(e,t,o){"use strict";e.exports=[]},function(e,t,o){"use strict";e.exports=function(e){if("account"===e.to)var t={method:"post",api:"accounts.files.finalizeUpload",params:{fileURL:e.url}};if("drive"===e.to)t={method:"post",api:"drive.objects.finalizeObjectUpload",projectID:e.projectID,params:{objectID:e.objectID}};stella.api.request(t,function(t){if(t.error)return stella.up.uploads[e.id].status="error",stella.up.uploads[e.id].error=t.error,void e.onError(stella.up.uploads[e.id]);stella.up.uploads[e.id].status="complete",e.onComplete(stella.up.uploads[e.id])})}},function(e,t,o){"use strict";e.exports=function(e){var t=stella.up.uploads[e];return stella.up.uploaders[e].abort(),stella.up.uploads[e].status="aborted",t.onAbort(stella.up.uploads[e]),stella.up.finalizeUpload(stella.up.uploads[e])}},function(e,t,o){"use strict";e.exports=function(e){var t=e.bucket||stella.config.bucket,o=new AWS.Credentials({accessKeyId:e.credentials.AccessKeyId,secretAccessKey:e.credentials.SecretAccessKey,sessionToken:e.credentials.SessionToken});AWS.config.region="us-east-1";var l=new AWS.S3({credentials:o,maxRetries:100,params:{Bucket:t}});stella.up.uploaders[e.id]=l.upload({Key:e.key,ACL:"private",ContentType:e.file.type,ContentLength:e.file.size,Body:e.file.buffer,ServerSideEncryption:"AES256"}),stella.up.uploaders[e.id].on("httpUploadProgress",function(t){var o=t.total,l=t.loaded,s=l/o*100;(new Date).getTime(),stella.up.uploads[e.id].date.initiated;stella.up.uploads[e.id].status="uploading",stella.up.uploads[e.id].loaded=l,stella.up.uploads[e.id].total=o,stella.up.uploads[e.id].percent=s,stella.up.uploads[e.id].rate="0Mbps",stella.up.uploads[e.id].remaining="0:00:00",e.onProgress(stella.up.uploads[e.id])}),stella.up.uploaders[e.id].send(function(t,o){t?(stella.up.uploads[e.id].status="error",stella.up.uploads[e.id].error=t,console.error("[stella.js] Upload error, please try again."),e.onError(stella.up.uploads[e.id])):stella.up.uploads[e.id].status="uploaded",stella.up.finalizeUpload(stella.up.uploads[e.id])})}},function(e,t,o){"use strict";e.exports=function(e){stella.util.getActiveAccount();var t=e.to||"drive";e.file;if("account"===t)var o={method:"post",api:"accounts.files.insertFile",params:{file:{name:e.file.name,size:e.file.size}}};if("drive"===t)o={method:"post",api:"drive.objects.insertObject",projectID:e.projectID,params:{locale:e.locale,parentID:e.parentID,objectType:e.objectType,title:e.file.name,filename:e.file.name}};stella.api.request(o,function(o){if(o.error)return stella.up.uploads[e.id].status="error",stella.up.uploads[e.id].error=o.error,console.error(error),console.info(stella.up.uploads[e.id]),void(e.onError&&e.onError(stella.up.uploads[e.id]));if(e.status="initialized","account"===t){var l=o.data.account;localStorage.setItem("stellaAccount",JSON.stringify(l));var s=o.data.file;e.objectID=null,e.url=s.url,e.key=s.key,e.ext=s.ext,e.credentials=s.credentials}if("drive"===t){var r=o.data;e.objectID=r._id,e.url=r.url,e.key=r.key,e.ext=r.ext,e.credentials=r.credentials}stella.up.uploads[e.id]=e,stella.up.uploadFile(stella.up.uploads[e.id]),e.onInit(stella.up.uploads[e.id])})}},function(e,t,o){"use strict";e.exports=function(e){return window.AWS?(e.id=stella.up.uploads.length,e.status="initializing",e.date={initiated:(new Date).getTime(),completed:0},stella.util.getActiveAccount()?(stella.up.uploads.push(e),void stella.up.initializeUpload(e)):(e.status="error",e.error="You Must Login To Upload A File",console.error("[stella.js] You must login to upload a file."),console.info(e),void e.onError(e))):(console.error("[stella.js] The AWS SDK for Javascript v2.171.0 or greater is required to upload files using Stella Up."),console.info("[stella.js] Visit the following URL for installation instructions:"),console.info("[stella.js] http://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/loading-the-jssdk.html"),void alert("You must install the AWS SDK v2.171.0 or greater to use Stella Up. See your console for more details."))}},function(e,t,o){"use strict";e.exports=function(e,t){if(e.method=e.method.toLowerCase()||"get",e.url=e.url||stella.config.api.url,e.version=e.version||stella.config.api.version,e.projectID=e.projectID||stella.config.projectID,e.auth=e.auth||{},e.auth.session=localStorage.getItem("stellaSession"),"get"===e.method){e.url+="/"+e.projectID,e.url+="/"+e.api.replace(/\./g,"-")+"/",e.url+="?"+stella.util.serialize(e.params);var o=null}if("post"===e.method)o=JSON.stringify(e);var l=new XMLHttpRequest;l.addEventListener("error",function(t){e.xhrError=t,console.log("[stella.js] XHR ERROR: Unable to contact "+stella.config.api.url+" due to network error"),console.log(e)}),l.addEventListener("load",function(e){var o=JSON.parse(e.target.response);if(o.auth?localStorage.setItem("stellaSession",o.auth.session):localStorage.removeItem("stellaSession"),t)return t(o)}),l.open(e.method,e.url,!0),l.setRequestHeader("Stella-Api",e.api),l.setRequestHeader("Stella-Api-Version",e.version),l.setRequestHeader("Stella-Project-Id",e.projectID),l.setRequestHeader("Stella-Auth",btoa(JSON.stringify(e.auth))),l.setRequestHeader("Content-Type","application/json;charset=UTF-8"),l.send(o)}},function(e,t,o){"use strict";e.exports={api:{url:"https://api.stellaverse.com",version:1},bucket:"cdn.stellaverse.com",projectID:"000000000000",recaptcha:{key:"6LeZ6RMTAAAAAFaHzXK76s60uMlBlKzSe5NsWUL1"}}},function(e,t,o){"use strict";var l={};l.config=o(11),l.api={request:o(10)},l.up={upload:o(9),initializeUpload:o(8),uploadFile:o(7),abortUpload:o(6),finalizeUpload:o(5),uploaders:o(4),uploads:o(3)},l.util={getActiveAccount:o(2),setActiveAccount:o(1),serialize:o(0)},e.exports=l},function(e,t,o){e.exports=o(12)}]);